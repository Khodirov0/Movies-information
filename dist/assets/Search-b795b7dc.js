import{p as N,q as E,s as M,x as T,y as q,m as z,r as c,c as F,n as P,z as I,b as k,o as r,d as u,e as v,f as d,w as j,v as K,A as U,k as y,F as x,B as Z,h as A,j as D}from"./index-6f6eabef.js";import{C as G}from"./ContentItem-9361b4db.js";const $=N("search",{state:()=>({searchArray:[],adult:!1,totalResults:0,totalPages:0}),actions:{async getSearch(_="",a=1){if(_!=="")try{const o=await E({method:"GET",url:`${M}/search/multi?query=${_}&include_adult=${this.adult}&language=${T}&page=${a}`,headers:q}),h=o.data.results.filter(e=>e.poster_path&&(e.original_language==="en"||e.name||e.title)&&e.vote_average>=5);this.searchArray=h.sort((e,p)=>(p.vote_average||0)-(e.vote_average||0)),this.totalPages=o.data.total_pages,this.totalResults=o.data.total_results}catch(o){console.error("Error in search.js: ",o)}else this.searchArray=[],this.totalPages=0,this.totalResults=0}}}),L={class:"search"},H={class:"container"},J={key:0,style:{color:"red"},class:"search__lang"},O={class:"search__top"},Q=["placeholder"],W={key:1,class:"search__recommend"},X={class:"content__list"},Y={class:"load-more__button"},ee={__name:"Search",props:{type:{type:String,required:!1,default:""}},setup(_){const a=$(),o=z(),h=c("Find a movie, series..."),e=c([]),p=F(()=>a.totalPages),t=c(""),i=c(1),s=c(!1),m=c(!1),R=c(!1),b=async()=>{s.value||(s.value=!0,i.value=1,await a.getSearch(t.value,i.value),e.value=[...a.searchArray],s.value=!1)},C=async()=>{!s.value&&i.value<p.value&&(s.value=!0,i.value+=1,await a.getSearch(t.value,i.value),e.value.push(...a.searchArray),s.value=!1)},V=g=>{/^[A-Za-z\s]*$/.test(g.target.value)?m.value=!1:(m.value=!0,t.value=t.value.replace(/[^A-Za-z\s]/g,""))},f=async()=>{s.value||(s.value=!0,await o.getPopular("movie"),e.value=[...o.movie.slice(0,4)],s.value=!1)},w=()=>{t.value="",f()};return P(()=>{f()}),I(t,g=>{g.trim()===""&&w()}),(g,l)=>{const S=k("font-awesome-icon"),B=k("loader");return r(),u(x,null,[v("section",L,[v("div",H,[m.value?(r(),u("p",J," Please use only English language!!! ")):d("",!0),v("div",O,[j(v("input",{type:"text",class:"search__input",placeholder:h.value,"onUpdate:modelValue":l[0]||(l[0]=n=>t.value=n),onKeydown:l[1]||(l[1]=U(n=>t.value.trim()?b():f(),["enter"])),onInput:V},null,40,Q),[[K,t.value]]),t.value!=""?(r(),u("button",{key:0,class:"search__button",onClick:w},[y(S,{icon:"times"})])):d("",!0)]),R.value?(r(),u("h2",W,"Recommended")):d("",!0),v("div",X,[(r(!0),u(x,null,Z(e.value,n=>(r(),A(G,{key:n.id,content:n,type:n.media_type||"",vote_average:n.vote_average},null,8,["content","type","vote_average"]))),128)),t.value&&e.value.length>4&&i.value<p.value?(r(),u("div",{key:0,onClick:C,class:"load-more"},[l[2]||(l[2]=D(" Show More ")),v("button",Y,[y(S,{icon:["fas","chevron-right"]})])])):d("",!0)])])]),s.value===!0?(r(),A(B,{key:0})):d("",!0)],64)}}},se={__name:"Search",setup(_){const a=$();return P(()=>{a.searchArray=[],a.totalPages=[],a.totalResults=[]}),(o,h)=>(r(),u("div",null,[y(ee)]))}};export{se as default};
